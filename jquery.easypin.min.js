!function(e){e.fn.easypin=function(a){a=a||{},localStorage&&localStorage.removeItem("easypin");var r=e.fn.easypin.defaults.parentClass,p=e.fn.easypin.defaults.pinMapClass,c=e.fn.easypin.defaults.hoverClass,f=e.fn.easypin.defaults.dashWidth,u=e.fn.easypin.defaults.imageZindex,l=e.fn.easypin.defaults.pinMapZindex,y=e.fn.easypin.defaults.hoverLayerZindex;e.extend(e.fn.easypin.defaults,a);var h=this,v=0,g=e(this).length;return h.each(function(t){e(this).css("opacity",0)}),e(this).on("load",function(){if(v+=1,e(this).animate({opacity:"1"},{duration:"fast",easing:"easeInQuad"}),v==g){h.each(function(t){var a=e(this).width(),s=e(this).height();if(s>0){var o=e(this).after(e("<div/>",{"class":r}).attr("data-index",b(n(r),document.body))).appendTo(n(r)+":last").css("position","absolute").css("z-index",u);if(e(this).addClass("easypin-target"),e(this).attr("easypin-id"))var p=e(this).attr("easypin-id");else{var p=S();e(this).attr("easypin-id",p)}o.parent().attr(e.fn.easypin.config("widthAttribute"),a).attr(e.fn.easypin.config("heightAttribute"),s).css({width:i(a),height:i(s),position:e.fn.easypin.config("parentPosition"),border:i(f)+" dashed #383838"}),O(p,e(this))}});var a=e(n(r));e(a).hover(function(){s("popup",e(this))||e(this).prepend(e("<div/>",{"class":c}).css({width:"100%",height:"100%",position:"absolute",opacity:0,"z-index":y,"background-color":"black",cursor:"copy"})).children(n(c)).animate({opacity:.2},800)},function(){e(this).children(n(c)).animate({opacity:0},"fast","swing",function(){e(this).remove()})}).append(e("<div/>",{"class":p}).css({position:"absolute","z-index":l})).bind("mousedown",function(a){if(!e(a.target).is(n(r))&&!e(a.target).is(n(c)))return void a.stopPropagation();if(1==a.which){var f=a.currentTarget,u=e(".easy-marker",f).size(),l=parseInt(e.fn.easypin.defaults.limit);if(0!=l&&u>=l)return void e.fn.easypin.defaults.exceeded("limit exceeded");var y=e("img"+n("easypin-target"),f).width(),h=e("img"+n("easypin-target"),f).height();e(n(p),f).css({width:i(y),height:i(h)});var v=e.fn.easypin.defaults.markerSrc,g=e.fn.easypin.defaults.markerWidth,m="auto"==e.fn.easypin.defaults.markerHeight?g:e.fn.easypin.defaults.markerHeight,x=e.fn.easypin.defaults.markerClass,w=e.fn.easypin.defaults.markerContainerZindex,C=e.fn.easypin.defaults.dashWidth,O=e.fn.easypin.defaults.posYBalance,S=e.fn.easypin.defaults.posXBalance,I=e("img"+n("easypin-target"),f),A=I.offset().top-(C-O),z=I.offset().left-(C-S),P=a.pageX-z,F=a.pageY-A,j=g/2,J=m/2,N=P-g/2,T=F-m/2;0>N?N=0:P+j>y&&(N=y-g),0>T?T=0:F+J>h&&(T=h-m);var L=N.toFixed(3)-j,Y=T.toFixed(3)-J,Z=e("<div/>",{"class":x}).css("left",i(N)).css("top",i(T-15)).css("width",g).css("height",m).css("position","absolute").css("opacity",0).css("z-index",w+10).css("background-image","url("+v+")").css("background-size",i(g)).css("cursor","move").attr(e.fn.easypin.config("xAttribute"),L).attr(e.fn.easypin.config("yAttribute"),Y).attr(e.fn.easypin.config("widthAttribute"),y).attr(e.fn.easypin.config("heightAttribute"),h).attr("data-index",b(".easy-marker",f)),E=e("<div/>",{"class":"easy-tools"}).css({width:i(g),height:"10px",position:"absolute","background-color":"#868585",left:"-1px",top:i(m+2-5),opacity:"0"}).append(function(){return e("<a/>",{"class":"easy-edit"}).css({display:"inline-block",width:i(g/2),height:"10px",position:"absolute",left:"0px","background-image":"url("+e.fn.easypin.defaults.editSrc+")","background-repeat":"no-repeat","background-size":"8px","background-position-y":"1px","background-position-x":"3px"}).hover(function(){e(this).css("background-color","black").css("opacity",".6")},function(){e(this).css("background-color","inherit")})}).append(function(){return e("<a/>",{"class":"easy-delete"}).css({display:"inline-block",width:i(g/2),height:"10px",position:"absolute",right:"0px","background-image":"url("+e.fn.easypin.defaults.deleteSrc+")","background-repeat":"no-repeat","background-size":"8px","background-position-y":"1px","background-position-x":"3px"}).hover(function(){e(this).css("background-color","black").css("opacity",".6")},function(){e(this).css("background-color","inherit")})}),R=e(Z).attr("data-index"),X=(e(f).attr("data-index"),e(".easypin-target",f).attr("easypin-id"));e(Z).on("click",".easy-delete",function(t){d(X,R),e(t.currentTarget).closest(".easy-marker").remove()}),e(Z).on("click",".easy-edit",function(e){var t=o(e,Z);k(X,R,t)}),e(Z).append(E);N.toFixed(3),T.toFixed(3);if(s("popup",f)?e(f).prepend(Z,e.fn.easypin.defaults.drop(L,Y,Z)):e(f).append(Z,e.fn.easypin.defaults.drop(L,Y,Z)),T+m+10>h)var U=-13;else var U=m+2;e(Z).animate({opacity:1,top:i(T)},{duration:"slow",easing:"easeOutElastic",complete:function(){e(E).animate({opacity:".4",top:i(U)},{duration:"slow",easing:"easeOutElastic"}).hover(function(){e(this).animate({opacity:"1"},{duration:"slow",easing:"easeInOutQuint"}).css("cursor","pointer")},function(){e(this).animate({opacity:".4"},{duration:"slow",easing:"easeInOutQuint"})})}});var B=e(n(x));e(B).bind("mousedown",function(a){if(a.stopPropagation(),1==a.which){var n=a.currentTarget;e(f).bind("mousemove",function(a){var s=e(n).parent(),o=e(n),r=e("img.easypin-target",s),p=g/2,c=m/2;liveY=a.pageY-r.offset().top,liveX=a.pageX-r.offset().left;var d=liveY,f=liveX;if(liveY-c<0)var d=c;else if(liveY+c>h)var d=h-c;if(liveX-p<0)var f=p;else if(liveX+p>y)var f=y-p;var u=f.toFixed(3)-p,l=parseInt(d.toFixed(3))+c;t(l,h,o),e.fn.easypin.defaults.drag(u,l,o),e(o).css({position:"absolute",top:i(d),left:i(f),marginTop:-(m/2),marginLeft:-(g/2)}).attr(e.fn.easypin.config("xAttribute"),u).attr(e.fn.easypin.config("yAttribute"),l)})}}),e(B).bind("mouseup",function(){e(f).unbind("mousemove")})}}),e.fn.easypin.di("instance",e.fn.easypin)}}),this};var t=function(t,a,n){var s=e(n).height(),o=t+10;o>a&&o==a+1?e(".easy-tools",n).animate({top:i(-13)},{duration:"slow",easing:"easeOutElastic"}):t-s-10==-1&&e(".easy-tools",n).animate({top:i(s+2)},{duration:"slow",easing:"easeOutElastic"})},a=function(t){switch(t){case"get.coordinates":if(localStorage)return JSON.parse(localStorage.getItem("easypin"));try{return JSON.parse(decodeURIComponent(e('input[name="easypin-store"]').val()))}catch(a){return null}break;default:return null}};getByIndex=function(e,t){if(t=t||{},e=parseInt(e),"object"==typeof t){var a=0;for(var n in t)if(a++,a==e)return t[n]}return{}},e.fn.easypinShow=function(t){t=t||{},e.extend(e.fn.easypinShow.defaults,t);try{var a=t.responsive||!1,n=(t.pin||"blaaa.png",t.animate||!1,t.animateType||"easeInQuad",t.data||{}),s="function"!=typeof t.error?function(e){}:t.error,o="function"!=typeof t.each?function(e,t){return t}:t.each,r="function"!=typeof t.success?function(){}:t.success,p=this,c=0,d=e(this).length;p.each(function(t){e(this).css("opacity",0)}),"string"==typeof n&&(n=JSON.parse(n)),e(this).on("load",function(){c+=1,e(this).animate({opacity:"1"},{duration:"fast",easing:"easeInQuad"}),c==d&&(p.each(function(t){var s=(e(this).parent(),e(this).height()),r=e(this).width();if(a===!0)var p="100%",c="100%";else var p=i(r),c=i(s);var d=e("<div/>").css({width:p,height:c,position:"relative"}).addClass("easypin");e(this).css("position","relative").replaceWith(d),e(d).html(e("<div/>").css("position","relative").css("height","100%").append(e(this)));var f=getByIndex(t+1,n);for(var u in f){var l=new Array;l.push(t),l.push(f[u]);var y=o.apply(null,l);e(d).append('<div style="position:absolute;top:0px;">'+y.firstname+"</div>")}}),r.apply())})}catch(f){var u=new Array;u.push(f.message),u.push(f),s.apply(null,u)}},e.fn.easypin.clear=function(){localStorage?localStorage.removeItem("easypin"):e('input[name="easypin-store"]').val("")},e.fn.easypin.event=function(t,a){e.fn.easypin.di(t,a)},e.fn.easypin.fire=function(t,n,i){if("undefined"!=typeof e.fn.easypin.container[t]){if("function"==typeof n?(i=n,n=null):(n=n||null,i=i||null),"function"==typeof i){var s=new Array;s.push(a(t));var o=i.apply(null,s)}else var o=a(t);var r=new Array;r.push(e.fn.easypin.container.instance),r.push(o),r.push(n),e.fn.easypin.container[t].apply(null,r)}},e.fn.easypin.config=function(t){return e.fn.easypin.defaults[t]},e.fn.easypin.di=function(t,a){e.fn.easypin.container[t]=a},e.fn.easypin.call=function(t,a){a=a||"";var n=t.toString().match(/function\s*\(\s*(.*?)\s*\)/i);if(n.length>1){n=n[1];var i=n.replace(/(\$[a-zA-Z]+)/g,"");i=i.replace(/\s+/g,""),i=i.replace(/,+/g,","),i=i.replace(/(^,)/,""),i=i.split(/,/g),expectParm=n.match(/(\$[a-zA-Z]+)/g);var s=new Array;for(var o in expectParm)e.fn.easypin.container[expectParm[o]]&&s.push(e.fn.easypin.container[expectParm[o]]);s.push(a),t.apply(null,s)}},e.fn.easypin.defaults={init:{},limit:0,popover:{},exceeded:function(){},drop:function(){},drag:function(){},modalWidth:"200px",widthAttribute:"data-width",heightAttribute:"data-height",xAttribute:"data-x",yAttribute:"data-y",parentClass:"pinParent",markerClass:"easy-marker",hoverClass:"hoverClass",pinMapClass:"pinCanvas",parentPosition:"relative",popupOpacityLayer:"popupOpacityLayer",markerWidth:32,markerHeight:"auto",animate:!1,posYBalance:2,posXBalance:2,dashWidth:2,imageZindex:1,pinMapZindex:2,hoverLayerZindex:3,markerContainerZindex:4,markerBorderColor:"#FFFF00",downPoint:10},e.fn.easypinShow.defaults={},e.fn.easypin.container={},e.fn.easypin.markerContainer={};var n=function(e){return"."+e},i=function(e){return e+"px"},s=function(t,a){if("popup"==t){var i=n(e.fn.easypin.defaults.popupOpacityLayer);return e(i,a).size()>0}},o=function(t,a){var o=e(t.target).closest(".pinParent"),p=(e(o).attr("data-index"),e(".easypin-target",o)),c=e.fn.easypin.defaults.widthAttribute,d=e.fn.easypin.defaults.heightAttribute,f=e("<div/>").addClass("popupOpacityLayer").css({width:"100%",height:"100%","background-color":"black",position:"absolute",opacity:".0","z-index":14});e(o).append(f).children(n(e.fn.easypin.defaults.hoverClass)).hide().parent().children(n(e.fn.easypin.defaults.popupOpacityLayer)).animate({opacity:.4},800);var u=parseInt(e(o).attr(c)),l=parseInt(e(o).attr(d)),y=e("<div/>").addClass("modalParent").css({width:"100%",height:"100%",position:"absolute","z-index":15}).click(function(t){e(t.target).is("div.modalParent")&&m(o),t.stopPropagation()}),h=e(".easy-modal:last").clone(),g=e("<div/>").addClass("modalContext").css({"background-color":"#fff",width:e.fn.easypin.defaults.modalWidth,opacity:"0",position:"absolute",padding:"10px","-webkit-box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)","-moz-box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)","box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)","-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px",cursor:"move"}).append(e(h).show()).appendTo(y);e(".popupOpacityLayer",o).after(y);var b=e(".modalContext").height(),w=e(g).width(),k=e(t.target).closest(n(e.fn.easypin.defaults.parentClass)).offset().left,O=e(t.target).offset().left,S=O-k,I=e(t.target).closest(n(e.fn.easypin.defaults.parentClass)).offset().top,A=e(t.target).offset().top,z=A-I;if("free"==e(h).attr("modal-position")){if(w>S-100)var P=S+e(a).width()+50;else var P=S-w-100;if(b>l)var F=I;else if(b>l-z)var F=l-(b+100);else var F=z-b/2}else var P=u/2-w/2-10,F=l/2-e(g).height()/2-10;return e(g).css("top",-(b+5)+"px").css("left",P+"px"),x(27,function(){s("popup",o)&&(m(o),e(document.body).unbind("keydown"))}),e(o).hover(function(){e(this).is(":hover")&&s("popup",o)&&x(27,function(){m(o)})},function(){e(document).unbind("keydown")}),e(g).animate({top:F+"px",opacity:"1"},{duration:"slow",easing:"easeOutElastic"}).bind("mousedown",function(t){if(!e(t.target).is("div.easy-modal")&&!e(t.target).is("div.modalContext")&&!e(t.target).is("form"))return void t.stopPropagation();var a=e(t.currentTarget).closest(".pinParent"),n=t.pageY-e(t.currentTarget).offset().top,s=t.pageX-e(t.currentTarget).offset().left;e(a).bind("mousemove",function(t){e(g).css({position:"absolute",top:i(t.pageY-o.offset().top-n),left:i(t.pageX-o.offset().left-s)})})}).bind("mouseup",function(t){var a=e(t.currentTarget).closest(".pinParent");e(a).unbind("mousemove")}),e(".easy-submit",g).click(function(){var t=e(a).attr(e.fn.easypin.defaults.xAttribute),n=e(a).attr(e.fn.easypin.defaults.yAttribute),i=e(a).attr(e.fn.easypin.defaults.widthAttribute),s=e(a).attr(e.fn.easypin.defaults.heightAttribute),c=e(a).attr("data-index"),d=e(".easypin-target",o).attr("easypin-id"),f=e("form",g).size()>0;if(f)var u=e("form",g);else var u=e(".easy-modal",g);var l=e.fn.easypin.defaults.done(u);"boolean"==typeof l?1==l&&m(o):m(o);var y=v(u,function(a){return a.canvas=new Object,a.canvas.src=e(p).attr("src"),a.canvas.lat=t,a.canvas["long"]=n,a.canvas.width=i,a.canvas.height=s,a});r(d,c,y),C(a,y)}),g},r=function(e,t,a){localStorage?p(e,t,a):c(e,t,a)},p=function(e,t,a){var n=localStorage.getItem("easypin");if(n)try{var n=JSON.parse(n)}catch(i){var n=new Object}else var n=new Object;var n=y(e,t,n);n[e][t]=a,localStorage.setItem("easypin",g(n))},c=function(t,a,i){var s=e('input[name="easypin-store"]').val();if(s)try{var s=JSON.parse(decodeURIComponent(s))}catch(o){var s=new Object}else var s=new Object;var s=y(t,a,s);s[t][a]=i,e('input[name="easypin-store"]').size()<1?e(n(e.fn.easypin.defaults.parentClass)+":first").before('<input type="hidden" name="easypin-store" value="'+encodeURIComponent(g(s))+'" />'):e('input[name="easypin-store"]').val(encodeURIComponent(g(s)))},d=function(e,t){localStorage?u(e,t):f(e,t)},f=function(t,a){var i=e('input[name="easypin-store"]').val();if(i){console.log(i);try{var i=JSON.parse(decodeURIComponent(i));i=l(t,a,i),e('input[name="easypin-store"]').size()<1?e(n(e.fn.easypin.defaults.parentClass)+":first").before('<input type="hidden" name="easypin-store" value="'+encodeURIComponent(g(i))+'" />'):e('input[name="easypin-store"]').val(encodeURIComponent(g(i)))}catch(s){}}},u=function(e,t){var a=localStorage.getItem("easypin");if(a)try{var a=JSON.parse(a);localStorage.setItem("easypin",g(l(e,t,a)))}catch(n){}},l=function(e,t,a){return e&&!t&&"undefined"!=typeof a[e]&&delete a[e],e&&t&&"undefined"!=typeof a[e][t]&&(delete a[e][t],w(a[e])<1&&delete a[e]),a},y=function(e,t,a){return"undefined"==typeof a[e]&&(a[e]=new Object),"undefined"==typeof a[e][t]&&(a[e][t]=new Object),a},h=function(t,a){if(t=parseInt(t),a=parseInt(a),localStorage){var n=localStorage.getItem("easypin");try{n=JSON.parse(n)}catch(i){n={}}}else{var n=e('input[name="easypin-store"]').val();try{n=JSON.parse(decodeURIComponent(n))}catch(i){n={}}}try{return n[t][a]}catch(i){return null}},v=function(t,a){var n=new Object;if(e("input, select, textarea",t).each(function(){var t=e(this).attr("type"),a=e(this).attr("name");if("radio"==t){var i=e(this).filter(":checked").val();"undefined"!=typeof i&&"undefined"==typeof n[a]&&(n[a]=i)}else"checkbox"==t?e(this).is(":checked")&&(n[a]=e(this).val()):n[a]=e(this).val()}),"function"==typeof a){var i=new Array;return i.push(n),a.apply(null,i)}return n},g=function(e){return JSON.stringify(e)},m=function(t){e(n(e.fn.easypin.defaults.popupOpacityLayer),t).animate({opacity:0},"fast","swing",function(){e(this).remove()});var a=e(".modalContext",t).height();e(".modalContext",t).width();e(".modalContext",t).animate({top:-(a+50)+"px",opacity:"0","z-index":0},{duration:"slow",easing:"easeOutElastic",complete:function(){e(".modalParent",t).remove()}})},x=function(t,a){e(document).bind("keydown",function(n){n.which==t&&(a.apply(null),e(this).unbind("keydown"))})},b=function(t,a){var n=e(t+":last",a).attr("data-index");return"undefined"==typeof n?"0":parseInt(n)+1},w=function(e){if("object"==typeof e){var t=0;for(var a in e)t++;return t}},k=function(t,a,n){var i=h(t,a);if("object"==typeof i)for(var s in i){var o=e('[name="'+s+'"]',n),r=e(o).prop("type");"text"==r||"hidden"==r?e(o).attr("value",i[s]):"checkbox"==r?e(o).attr("checked",!0):"radio"==r?e('[value="'+i[s]+'"]',n).attr("checked",!0):"textarea"==r?e(o).val(i[s]):"select-one"==r&&e(o).val(i[s]).prop("selected",!0)}},C=function(t,a){var n=e("<div/>").addClass("popover-arrow-down").css({width:0,height:0,"border-left":"10px solid transparent","border-right":"10px solid transparent","border-top":"10px solid #000",opacity:".8",position:"absolute",bottom:"-50px",left:"58px"}),s=e("<div/>").addClass("popover").css("position","absolute").css("display","inline").css("top","-51px").css("left","-51px").css("opacity","0"),o=e("[popover]:last").clone();o.removeAttr("popover");var r=o.html(),p=o.attr("width")?o.attr("width"):150,c=e("<span/>").css({position:"absolute",width:i(p),color:"#FFFFFF",background:"#000000",opacity:".8",height:"auto","line-height":"40px","border-radius":"5px",cursor:"context-menu"});"true"==o.attr("shadow")&&e(c).css({"-webkit-box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)","-moz-box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)","box-shadow":"10px 13px 5px 0px rgba(0,0,0,0.75)"}),delete a.canvas;var d=w(e.fn.easypin.defaults.popover)>0?e.fn.easypin.defaults.popover:!1;for(var f in a){if(d&&"function"==typeof d[f]){var u=new Array;u.push(a[f]),a[f]=d[f].apply(null,u)}var l=RegExp("\\{\\["+f+"\\]\\}","g");r=r.replace(l,a[f])}e(c).append(r),e(s).append(c).append(n),e("div.popover",t).size()>0&&e("div.popover",t).animate({top:"-"+i(h-15),opacity:"0"},{duration:"slow",easing:"easeOutElastic",complete:function(){e(this).remove(),e(".popover-arrow-down",t).remove()}}),e(t).prepend(s);var y=e("div.popover > span:first",t),h=y.height(),v=y.width();e(s).css("top","-"+i(h+12-10)).css("left","-"+i(v/2-16)),e(n,s).css("left",i(v/2-10)).css("top",i(h)),e(s).animate({top:"-"+i(h+12),opacity:"1"},{duration:"slow",easing:"easeOutElastic"})},O=function(t,a){var n=e.fn.easypin.defaults.init;"string"==typeof n&&(n=JSON.parse(n)),w(n)>0&&"false"!=e(a).attr("easypin-init")&&console.log(t)},S=function(){for(var e=10,t="abcdefghijklmnoprstuvyzABCDEFGHIJKLMNOPRSTUVYZ1234567890_",a="",n=1;e>=n;n++){var i=Math.floor(Math.random()*(t.length-1+1)+1);"undefined"!=typeof t[i]&&(a+=t[i])}return a}}(jQuery);
//# sourceMappingURL=jquery.easypin.min.js.map